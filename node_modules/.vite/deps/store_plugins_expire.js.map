{
  "version": 3,
  "sources": ["../../store/plugins/expire.js"],
  "sourcesContent": ["var namespace = 'expire_mixin'\n\nmodule.exports = expirePlugin\n\nfunction expirePlugin() {\n\tvar expirations = this.createStore(this.storage, null, this._namespacePrefix+namespace)\n\t\n\treturn {\n\t\tset: expire_set,\n\t\tget: expire_get,\n\t\tremove: expire_remove,\n\t\tgetExpiration: getExpiration,\n\t\tremoveExpiredKeys: removeExpiredKeys\n\t}\n\t\n\tfunction expire_set(super_fn, key, val, expiration) {\n\t\tif (!this.hasNamespace(namespace)) {\n\t\t\texpirations.set(key, expiration)\n\t\t}\n\t\treturn super_fn()\n\t}\n\t\n\tfunction expire_get(super_fn, key) {\n\t\tif (!this.hasNamespace(namespace)) {\n\t\t\t_checkExpiration.call(this, key)\n\t\t}\n\t\treturn super_fn()\n\t}\n\t\n\tfunction expire_remove(super_fn, key) {\n\t\tif (!this.hasNamespace(namespace)) {\n\t\t\texpirations.remove(key)\n\t\t}\n\t\treturn super_fn()\n\t}\n\t\n\tfunction getExpiration(_, key) {\n\t\treturn expirations.get(key)\n\t}\n\t\n\tfunction removeExpiredKeys(_) {\n\t\tvar keys = []\n\t\tthis.each(function(val, key) {\n\t\t\tkeys.push(key)\n\t\t})\n\t\tfor (var i=0; i<keys.length; i++) {\n\t\t\t_checkExpiration.call(this, keys[i])\n\t\t}\n\t}\n\t\n\tfunction _checkExpiration(key) {\n\t\tvar expiration = expirations.get(key, Number.MAX_VALUE)\n\t\tif (expiration <= new Date().getTime()) {\n\t\t\tthis.raw.remove(key)\n\t\t\texpirations.remove(key)\n\t\t}\n\t}\n\t\n}\n"],
  "mappings": ";;;;;AAAA;AAAA;AAAA,QAAI,YAAY;AAEhB,WAAO,UAAU;AAEjB,aAAS,eAAe;AACvB,UAAI,cAAc,KAAK,YAAY,KAAK,SAAS,MAAM,KAAK,mBAAiB,SAAS;AAEtF,aAAO;AAAA,QACN,KAAK;AAAA,QACL,KAAK;AAAA,QACL,QAAQ;AAAA,QACR;AAAA,QACA;AAAA,MACD;AAEA,eAAS,WAAW,UAAU,KAAK,KAAK,YAAY;AACnD,YAAI,CAAC,KAAK,aAAa,SAAS,GAAG;AAClC,sBAAY,IAAI,KAAK,UAAU;AAAA,QAChC;AACA,eAAO,SAAS;AAAA,MACjB;AAEA,eAAS,WAAW,UAAU,KAAK;AAClC,YAAI,CAAC,KAAK,aAAa,SAAS,GAAG;AAClC,2BAAiB,KAAK,MAAM,GAAG;AAAA,QAChC;AACA,eAAO,SAAS;AAAA,MACjB;AAEA,eAAS,cAAc,UAAU,KAAK;AACrC,YAAI,CAAC,KAAK,aAAa,SAAS,GAAG;AAClC,sBAAY,OAAO,GAAG;AAAA,QACvB;AACA,eAAO,SAAS;AAAA,MACjB;AAEA,eAAS,cAAc,GAAG,KAAK;AAC9B,eAAO,YAAY,IAAI,GAAG;AAAA,MAC3B;AAEA,eAAS,kBAAkB,GAAG;AAC7B,YAAI,OAAO,CAAC;AACZ,aAAK,KAAK,SAAS,KAAK,KAAK;AAC5B,eAAK,KAAK,GAAG;AAAA,QACd,CAAC;AACD,iBAAS,IAAE,GAAG,IAAE,KAAK,QAAQ,KAAK;AACjC,2BAAiB,KAAK,MAAM,KAAK,EAAE;AAAA,QACpC;AAAA,MACD;AAEA,eAAS,iBAAiB,KAAK;AAC9B,YAAI,aAAa,YAAY,IAAI,KAAK,OAAO,SAAS;AACtD,YAAI,cAAc,IAAI,KAAK,EAAE,QAAQ,GAAG;AACvC,eAAK,IAAI,OAAO,GAAG;AACnB,sBAAY,OAAO,GAAG;AAAA,QACvB;AAAA,MACD;AAAA,IAED;AAAA;AAAA;",
  "names": []
}
